SELECT current_database();

\c DBCorebiz;

CREATE SCHEMA IF NOT EXISTS partnerbenefit;

CREATE TABLE partnerbenefit.benefit_master (
    partner_code VARCHAR(10) NOT NULL,
    plan_code VARCHAR(10) NOT NULL,
    policy_no VARCHAR(20),
    temp_policy_no VARCHAR(20),
    mode INT,
    pay_period VARCHAR(10),
    policy_status CHAR(1),
    policy_status_date DATE,
    sum DECIMAL(15, 2) NOT NULL
);

INSERT INTO partnerbenefit.benefit_master (
  partner_code, plan_code, policy_no, temp_policy_no, mode,
  pay_period, policy_status, policy_status_date, sum
)
VALUES
-- 1
('907.777', 'PL22', NULL      ,'VL857265', 9, '0101', NULL, '2022-04-20', 281000),
-- 2
('071.806', 'GI44', '61000034', 'UI090293', 1, '0101', 'A', '2020-07-08', 100000),
-- 3
('071.806', 'GI44', '61000036', 'UI090294', 1, '0101', 'A', '2020-07-08', 100000),
-- 4
('071.806', 'GI44', '61000037', 'UI090298', 1, '0101', 'A', '2020-07-08', 50000),
-- 5
('071.806', 'GI44', '61000038', 'UI090300', 1, '0101', 'A', '2020-07-08', 100000),
-- 6
('022.804', 'GNZ', '61000938', 'UI090678', 1, '0101', 'A', '2020-07-31', 100000),
-- 7
('022.804', 'GE16', '61000940', 'UI090372', 1, '0101', 'A', '2020-07-31', 13000000),
-- 8
('022.804', 'GNZ', '39931522', 'UI039201', 4, '0604', 'A', '2020-07-03', 50000),
-- 9
('022.804', 'GNY', '39979909', 'UI081417', 1, '0201', 'A', '2020-07-07', 20000),
-- 10
('022.804', 'GI08', '39977970', 'UI080573', 1, '0201', 'A', '2020-07-03', 3000000),
-- 11
('022.804', 'GE01', '39946607', 'UI056612', 1, '0501', 'A', '2020-07-01', 4300000),
-- 12
('022.804', 'GE16', '39969386', 'UI077649', 1, '0301', 'A', '2020-07-09', 330000),
-- 13
('022.804', 'GI08', '39964166', 'UI075441', 1, '0301', 'A', '2020-07-01', 1000000),
-- 14
('022.804', 'GI08', '39964234', 'UI075438', 1, '0301', 'A', '2020-07-01', 5000000),
-- 15
('022.804', 'GNY', '39949019', 'UI059602', 1, '0501', 'A', '2020-07-01', 1000000),
-- 16
('917.774', 'PT08', '00433976', NULL, 0, '0309', 'I', '2019-08-19', 100000),
-- 17
('917.774', 'PT05', '00470379', NULL, 0, '0507', 'I', '2019-08-19', 100000),
-- 18
('917.774', 'PT02', '39972786', 'VL277658', 0, '0110', 'I', '2019-08-21', 100000),
-- 19
('917.774', 'PT06', '00426994', NULL, 0, '0302', 'C', '2019-08-21', 100000),
-- 20
('917.774', 'PT08', '00434009', NULL, 0, '0309', 'I', '2019-08-22', 150000),
-- 21
('917.774', 'PT08', '00434023', NULL, 0, '0309', 'I', '2019-08-23', 100000),
-- 22
('917.774', 'PT01', '39974396', 'VL297814', 0, '0109', 'L', '2019-08-26', 100000),
-- 23
('071.806', 'GI09', '39971376', 'UI078306', 1, '0201', 'A', '2019-11-26', 1000000),
-- 24
('071.806', 'GI33', '39973023', 'UI078582', 1, '0201', 'A', '2019-11-26', 100000),
-- 25
('071.806', 'GI09', '39959402', 'UI070636', 1, '0301', 'A', '2019-11-26', 50000),
-- 26
('071.806', 'GI09', '39959403', 'UI070637', 1, '0301', 'A', '2019-11-26', 50000),
-- 27
('071.806', 'GI33', '39972961', 'UI078574', 1, '0201', 'A', '2019-11-27', 100000),
-- 28
('071.806', 'GI33', '39972912', 'UI078479', 1, '0201', 'A', '2019-11-27', 100000),
-- 29
('071.806', 'GN09', '39973892', 'UI078823', 1, '0201', 'A', '2019-11-27', 50000),
-- 30
('071.806', 'GI09', '39952989', 'UI063903', 1, '0401', 'A', '2019-11-27', 100000),
-- 31
('071.806', 'GI09', '39953068', 'UI064003', 1, '0401', 'A', '2019-11-27', 50000);

SELECT *
FROM partnerbenefit.benefit_master
WHERE partner_code LIKE '071.%';

SELECT *
FROM partnerbenefit.benefit_master
WHERE policy_status_date >= '2020-01-01'
  AND policy_status_date <= '2020-12-31';

SELECT *
FROM partnerbenefit.benefit_master
WHERE sum BETWEEN 100000 AND 500000;
